<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>优惠券满减活动</title>
		<link rel="stylesheet" type="text/css" href="css/mui.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/spike.css"/>
		<script src="js/mui.min.js"></script>
		<script src="js/jquery-1.9.1.min.js"></script>
		<script src="js/iscroll-probe.js"></script>
	</head>
	<body>
		<div class="contain">
			<img class="banner" src="img/bg_banner.jpg" />
			<div class="coupon_img">
				<ul>
					<li>
						<a>
							<div class="left"><span>￥</span>100</div>
							<div class="name">蓄电池</div>
							<div class="right">
								<span>满300可用</span>
							</div>
							<p>立即领取</p>
						</a>
					</li>
					<li>
						<a>
							<div class="left"><span>￥</span>100</div>
							<div class="name">蓄电池</div>
							<div class="right">
								<span>满300可用</span>
							</div>
							<p>立即领取</p>
						</a>
					</li>
					<li>
						<a>
							<div class="left"><span>￥</span>100</div>
							<div class="name">蓄电池</div>
							<div class="right">
								<span>满300可用</span>
							</div>
							<p>立即领取</p>
						</a>
					</li>
					<li>
						<a>
							<div class="left"><span>￥</span>100</div>
							<div class="name">蓄电池</div>
							<div class="right">
								<span>满300可用</span>
							</div>
							<p>立即领取</p>
						</a>
					</li>
					<li>
						<a>
							<div class="left"><span>￥</span>100</div>
							<div class="name">蓄电池</div>
							<div class="right">
								<span>满300可用</span>
							</div>
							<p>立即领取</p>
						</a>
					</li>
					
				</ul>
			</div>
			<div class="content">
				<div class="product">
					<ul>
						<li>
							<p class="name">应急电源</p>
						</li>
						<li>
							<p class="name">机油</p>
						</li>
						<li>
							<p class="name">蓄电池</p>
						</li>
						<li>
							<p class="name">火花塞</p>
						</li>
						<li>
							<p class="name">滤芯器</p>
						</li>
					</ul>
				</div>
				<div class="pro_list_box">
					<div class="goods_box goods_box1">
						<img src="img/title_battery.png" />
						<a class="receive_coupons">领取优惠券1</a>
						<ul>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
								
						</ul>
					
					</div>
					<div class="goods_box goods_box2">
						<img src="img/title_battery.png" />
						<a class="receive_coupons">领取优惠券1</a>
						<ul>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
								
						</ul>
					
					</div>
					<!--<div class="goods_box2 column">
						<img src="img/title_battery.png" />
						<a class="receive_coupons">领取优惠券2</a>
						<ul>
							<li>
								<img src="img/good.png" />
								<p class="name mui-ellipsis">
									安马自达电池蓄电池池蓄池蓄电池电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
								</p>
								<div class="left">
									<p class="current_price">￥<span>100</span>.00</p>
									<p class="original_price">￥200.00</p>
								</div>
								<div class="right"><a href="##"> </a></div>
							</li>
							<li>
								<img src="img/good.png" />
								<p class="name mui-ellipsis">
									安马自达电池蓄电池池蓄池蓄电池电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
								</p>
								<div class="left">
									<p class="current_price">￥<span>100</span>.00</p>
									<p class="original_price">￥200.00</p>
								</div>
								<div class="right"><a href="##"> </a></div>
							</li>
						</ul>
						<a class="more_choose">更多选择</a>
					</div>-->
					<div class="goods_box goods_box3">
						<img src="img/title_battery.png" />
						<a class="receive_coupons">领取优惠券3</a>
						<ul>
							
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
								
						</ul>
					
					</div>
					<div class="goods_box goods_box4">
						<img src="img/title_battery.png" />
						<a class="receive_coupons">领取优惠券4</a>
						<ul>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis-2">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis-2">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis-2">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis-2">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
							<li>
								<img class="left" src="img/good.png"/>
								<div class="right good_msg">
									<div class="name mui-ellipsis-2">
										长安马自达电池蓄电池HFKN以旧换新长安马自达电池蓄电池H9以旧换新
									</div>
									<div class="price_box">
										<div class="price_top">
											<div class="left">
												<span class="current_price">￥<span>100</span>.00</span>
												<p class="original_price">￥200.00</p>
											</div>
											<a href="##"> </a>
										</div>
									</div>
									
								</div>
							</li>
								
						</ul>
					
					</div>
				<p style="width: 100%;height: 30px;"></p>
				</div>
			</div>
			<div class="go_top"></div>
	</body>
	<script>
	$(function(){
		
	
		var screenHeight = window.screen.availHeight;
		$(".pro_list_box>div:first").html("<a href='http://order.autocamel.com/cshop/weixin/goods/goods.detail.jsp?goodsId=457523185379969024&gsId=458612908122966016'class='buyItNow' ><img style='width: 100%;height: 52.27vw;' src='img/pro_battery_emergcy.jpg' /></a>")
		//$(".pro_list_box>div:nth-child(2)").append("<a href='http://order.autocamel.com/cshop/weixin/goods/goods_list.jsp?cShopMultistageClassId=785152354678005760' class='more_choose'>查看更多</a>");
		//$(".pro_list_box>div:nth-child(3)").append("<a href='http://order.autocamel.com/cshop/weixin/goods/goods_list.jsp?cShopMultistageClassId=785152354678005760' class='more_choose'>查看更多</a>");
		 /*$(".buyItNow").on("tap",function(){
		   var goodsId = $(this).attr("gsGoodsId");
	       var gsId = $(this).attr("goodsId");
            window.location.href = "http://order.autocamel.com/cshop/weixin/goods/goods.detail.jsp?goodsId="+goodsId+"&gsId="+gsId;
	  	 })*/
	//产品名称列表
		var length = $(".product ul li").length;
		$(".product ul li:first-child").addClass("active");
		var width = window.screen.availWidth/4;
		var allW = width*length;
		if(length>4){
			$(".product ul li").css("width",width+"px");
			$(".product ul").css("width",allW+"px");
			var typelist = new IScroll(".product",{
				//probeType:3,
				scrollX:true,
				scrollY:false,
				click:true,
				taps:true
			})
		}
		var arrTop=[];
		var topHeight= 0;
		var divLength = $(".pro_list_box>div").length;
		var setTop = $(".product").offset().top;
		
		arrTop[0] = setTop;
		for(var i = 1, j = 0;i < divLength;i++){
			 //topHeight= 0;
			for(;j < i;j++){
				topHeight += $(".pro_list_box>div").eq(j).height();
				//console.log(topHeight)
			}
			arrTop[i] = topHeight-44;
		}
		//var firstClick = true;
		$(".product li").click(function(){
			$(".product").css("position","fixed");
			var index = $(this).index();
			$(this).siblings().removeClass("active");
			$(this).addClass("active");
			//var top = $(".pro_list_box>div").eq(index).offset().top;
			if(index == 0){
				$(window).scrollTop(arrTop[index]);
				//$(window).scrollTop(arrTop[index]-44);
			}else{
				$(window).scrollTop(arrTop[index]+setTop+44);
				//console.log(arrTop[index]+setTop+44+ "  "+$(".pro_list_box>div").eq(index).offset().top);
			}
			
			//console.log(index + "     " +arrTop[index])
		})
		$(window).scroll(function(){
			
			var beforeScroll = $(window).scrollTop();
			$(window).scroll(function(){
				var afterScroll = $(window).scrollTop();
				if(afterScroll >= setTop-44 && beforeScroll <= afterScroll){
					$(".product").css("position","fixed");
					$(".buyItNow img").css("margin-top","44px");
					$(".go_top").css("display","block");
					for(var i=0;i<divLength;i++){
						//var top = $(".pro_list_box>div").eq(i).offset().top-44;
						//console.log(top +" "+i)
			        	if(afterScroll >= (arrTop[i]+setTop-44)){
			        		if(i > 3){
			        			$(".product ul").css("transform","translate(-"+window.screen.availWidth+"px, 0px) translateZ(0px)");
			        		}else{
			        			$(".product ul").css("transform","translate(0px, 0px) translateZ(0px)");
			        		}
			        		$(".product li").removeClass("active");
							$(".product li").eq(i).addClass("active");
			        	}
			        }
				}
				if(afterScroll < setTop-4 && beforeScroll > afterScroll){
					$(".product").css("position","initial");
					$(".buyItNow img").css("margin-top","0");
					$(".go_top").css("display","none");
					$(".product li").removeClass("active");
					$(".product li").eq(0).addClass("active");
				}
			})
		})
		$(".go_top").on("tap",function(){
			$(window).scrollTop(0);
			$(".product").css("position","initial");
			$(".product li").removeClass("active");
			$(".product li").eq(0).addClass("active");
		})
	})
		/*$(function(){
			var screenHeight = window.screen.availHeight;
			$(".contain").css("height",screenHeight+"px");
			$(".pro_list_box").css("height",screenHeight-220+"px");
			//优惠券列表
			var length_1 = $(".coupon_img ul li").length;
			var width_1 = window.screen.availWidth/3;
			var allW_1 = width_1*length_1;
			if(length_1>3){
				$(".coupon_img ul li").css("width",width_1+"px");
				$(".coupon_img ul").css("width",allW_1+"px");
				var typelist = new IScroll(".coupon_img",{
					//probeType:3,
					scrollX:true,
					scrollY:false,
					click:true,
					taps:true
				})
			}
			//产品名称列表
			var length = $(".product ul li").length;
			$(".product ul li:first-child").addClass("active");
			var width = window.screen.availWidth/4;
			var allW = width*length;
			if(length>4){
				$(".product ul li").css("width",width+"px");
				$(".product ul").css("width",allW+"px");
				var typelist = new IScroll(".product",{
					//probeType:3,
					scrollX:true,
					scrollY:false,
					click:true,
					taps:true
				})
			}
			var arrTop=[];
			var topHeight= 0;
			var divLength = $(".pro_list_box>div").length;
			arrTop[0] = 0;
			for(var i = 1, j = 0;i < divLength;i++){
				 //topHeight= 0;
				for(;j < i;j++){
					topHeight += $(".pro_list_box>div").eq(j).height();
					console.log(topHeight)
				}
				arrTop[i] = topHeight;
			}
			console.log(arrTop);
			$(".product li").click(function(){
				//$(".pro_list_box").css("height",screenHeight-220+"px");
				var index = $(this).index();
				$(this).siblings().removeClass("active");
				$(this).addClass("active");
				//var top = parseInt($(".pro_list_box>div").eq(index).offset().top);
				$(".pro_list_box").scrollTop(arrTop[index]);
				//console.log($(".pro_list_box").scrollTop())
			})
			
				
			$(".pro_list_box").scroll(function(){
				//$(".pro_list_box").css("height","auto")
				var scroll_length = $(".pro_list_box").scrollTop();
				console.log(scroll_length)
				for(var i=0;i<arrTop.length;i++){
		        	if(scroll_length >= arrTop[i]){
		        		//console.log(scroll_length+"     "+arrTop[i]);
		        		if(i > 3){
		        			$(".product ul").css("transform","translate(-"+window.screen.availWidth+"px, 0px) translateZ(0px)");
		        		}else{
		        			$(".product ul").css("transform","translate(0px, 0px) translateZ(0px)");
		        		}
		        		$(".product li").removeClass("active");
						$(".product li").eq(i).addClass("active");
		        	}
		        }
				
			})
	})*/
	</script>
</html>
